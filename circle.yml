machine:
  environment:
    jar_file: target/TuneJar-v0.1-beta-jar-with-dependencies.jar
  java:
    version: oraclejdk8

dependencies:
  override:
    - curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | sudo bash
    - sudo apt-get install git-lfs=1.1.0
    - ssh git@github.com git-lfs-authenticate sudiamanj/TuneJar.git download
    - git lfs pull

deployment:
  master:
    branch: master
    commands:
      - mv $jar_file TuneJar.jar

general:
  artifacts:
    - "TuneJar.jar"

test:
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - find . -type f -regex ".*/target/surefire-reports/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;
